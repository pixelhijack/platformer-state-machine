{"version":3,"sources":["webpack:///webpack/bootstrap a8ef528736013002ba39","webpack:///./client/src/index.js"],"names":["config","game","width","height","blocks","domElement","levels","key","exit","keyboard","events","type","action","state","e","start","payload","console","log","GameState","level","find","EVENTS","KEYS","STATE","adHocConfig","forEach","subscribe","event","input","onDownCallback","dispatch","code","toUpperCase","priority","args","Phaser","Signal","add","warn","data","State","Game","AUTO","map","someData"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a8ef528736013002ba39","// serializable config per level = Phaser2 GameState\nconst config = {\n    game: {\n        width: 546,\n        height: 368,\n        blocks: 3,\n        domElement: 'game'\n    }, \n    levels: [\n        {\n            key: 'menu',\n            exit: 'level 1',\n            keyboard: {\n                '*': 'LEVEL:NEXT',\n                'SPACE': 'PLAYER:HIT'\n            }\n        },\n        {\n            key: 'level 1',\n            exit: 'level 2',\n            keyboard: {\n                'SPACE': 'PLAYER:HIT',\n                'ARROWUP': 'PLAYER:JUMP',\n                'ARROWDOWN': 'PLAYER:DUCK',\n                'ARROWLEFT': 'PLAYER:LEFT',\n                'ARROWRIGHT': 'PLAYER:RIGHT'\n            }\n        },\n        {\n            key: 'level 2',\n            exit: 'level 3'\n        },\n        {\n            key: 'game over',\n            exit: 'menu'\n        }\n    ]\n};\n\nconst events = [\n    {\n        type: 'LEVEL:NEXT',\n        action: ({state, game, e}) => {\n            game.state.start('level 1');\n        }\n    },{\n        type: 'PLAYER:HIT',\n        action: (payload) => {\n            console.log('[ EVENT ] ', payload);\n        }\n    }\n];\n\nclass GameState extends Phaser.State {\n    constructor(key, config)Â {\n        super();\n        this.config = {\n            game: config.game,\n            level: config.levels.find(level => level.key === key),\n            events: events\n        };\n        this.EVENTS = {};\n        this.KEYS = {};\n        this.STATE = {};\n    }\n    init(adHocConfig){\n        console.log('[ GAMESTATE ] %s init', this.config.level.key, adHocConfig);\n    }\n    preload(){\n        console.log('[ GAMESTATE ] %s preload', this.config.level.key);\n    }\n    create(){\n        console.log('[ GAMESTATE ] %s create', this.config.level.key);\n        // subscribe events\n        this.config.events.forEach(event => {\n            this.subscribe(event.type, event.action);\n        });\n\n        // setup keyboard events\n        this.KEYS = this.config.level.keyboard;\n        this.game.input.keyboard.onDownCallback = (e) => {\n            const payload = { \n                e: e, \n                game: this.game,\n                state: this.STATE\n            };\n            // 1. any key pressed: \n            this.KEYS['*'] &&\n            this.dispatch(this.KEYS['*'], payload);\n            \n            // 2. single key pressed: \n            this.KEYS[e.code.toUpperCase()] &&\n            this.dispatch(this.KEYS[e.code.toUpperCase()], payload);\n\n            // 3. combo keys pressed\n            // WIP\n        };\n    }\n    update(){\n        console.log('[ GAMESTATE ] %s update', this.config.level.key);\n    }\n\n    subscribe(type, action, priority, args){\n        if(!this.EVENTS[type]){\n            this.EVENTS[type] = new Phaser.Signal();\n        };\n        this.EVENTS[type].add(action, this, priority, args);\n    }\n    dispatch(type, args){\n        if(this.EVENTS[type]){\n            this.EVENTS[type].dispatch(args);\n            console.log('[ EVENTS ] %s dispatched', type, args);\n        } else {\n            console.warn('[ GameState.dispatch ] %s event fired, missing a handler!', type);\n        };\n    }\n    nextLevel(data) {\n        this.game.state.start(this.config.level.exit, true, true, data);\n    }\n};\n\nconst game = new Phaser.Game(\n    config.game.width,\n    config.game.height,\n    Phaser.AUTO,\n    config.game.domElement\n);\n\nconst levels = config.levels.map(\n    level => game.state.add(level.key, new GameState(level.key, config))\n);\n\ngame.state.start('menu', true, true, { someData: 'state from previous level' });\n\n\n/////////////////////////////////////////////\n/*\nimport StateMachine from 'javascript-state-machine';\n\nimport Boot from './boot';\nimport Menu from './menu';\nimport Game from './game';\nimport GameOver from './gameover';\nimport GameState from './gamestate';\nimport ExtendedSprite from './extendedsprite';\nimport config from './config';\n\nconst events = [\n    {\n        event: 'PLAYER:MOVE',\n        action: (state, props) => {\n            state.player.x += props.velocity\n        }\n    },{\n\n    }\n];\n\nconst store = new StateMachine({\n    init: 'boot',\n    transitions: [\n        { name: 'initialize', from: 'boot', to: 'menu' },\n        { name: 'play',       from: 'menu', to: 'game' },\n        { name: 'abandon',    from: 'game', to: 'menu' },\n        { name: 'lose',       from: 'game', to: 'menu' }\n    ],\n    data: {\n\n    },\n    methods: {\n        onAbandon: () => { console.log('[STATE] onAbandon'); },\n        onLose: () => { console.log('[STATE] onLose'); },\n        onPlay: (lifecycle, level) => {\n            console.log('[STATE] onPlay');\n            game.state.start('Game', true, true, {\n                config: config,\n                keyboardEvents: {\n                    'SPACE': 'PLAYER:HIT',\n                    'ARROWUP': 'PLAYER:JUMP',\n                    'ARROWDOWN': 'PLAYER:DUCK',\n                    'ARROWLEFT': 'PLAYER:LEFT',\n                    'ARROWRIGHT': 'PLAYER:RIGHT'\n                },\n                events: [\n                    {\n                        type: 'GAME:ABANDON',\n                        action: function() {\n                            store.abandon();\n                        }\n                    },{\n                        type: 'GAME:OVER',\n                        action: function() {\n                            store.lose();\n                        }\n                    },{\n                        type: 'PLAYER:HIT',\n                        action: function(event) {\n                            this.PLAYER.hit();\n                        }\n                    },{\n                        type: 'PLAYER:JUMP',\n                        action: function(event) {\n                            this.PLAYER.jump();\n                        }\n                    },{\n                        type: 'PLAYER:DUCK',\n                        action: function(event) {\n                            this.PLAYER.duck();\n                        }\n                    },{\n                        type: 'PLAYER:LEFT',\n                        action: function(event) {\n                            this.PLAYER.moveLeft();\n                        }\n                    },{\n                        type: 'PLAYER:RIGHT',\n                        action: function(event) {\n                            this.PLAYER.moveRight();\n                        }\n                    }\n                ]\n            });\n        },\n        onInitialize: (lifecycle, config) => {\n            console.log('[STATE] onInitialize', lifecycle, config);\n            game.state.add('Boot', Boot);\n            game.state.add('Menu', Menu);\n            game.state.add('Game', Game);\n            game.state.add('GameOver', GameState);\n            game.state.start('Menu', true, true, {\n                config: config,\n                keyboardEvents: {\n                    'SPACE': 'GAME:START'\n                },\n                events: [\n                    { type: 'GAME:START', action: function() { store.play()} }\n                ]\n            });\n        }\n    }\n});\n\nstore.initialize(config);\n*/\n\n\n\n// WEBPACK FOOTER //\n// ./client/src/index.js"],"sourceRoot":""}